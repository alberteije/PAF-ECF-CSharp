CREATE
VIEW VIEW_PESSOA_FORNECEDOR
AS

select 
	F.ID,
	F.ID_CONTABIL_CONTA,
	F.ID_PESSOA,
	F.ID_ATIVIDADE_FOR_CLI,
	F.ID_SITUACAO_FOR_CLI,
	F.DESDE,
	F.OPTANTE_SIMPLES_NACIONAL,
	F.LOCALIZACAO,
	F.DATA_CADASTRO,
	F.SOFRE_RETENCAO,
	F.CHEQUE_NOMINAL_A,
	F.OBSERVACAO,
	F.CONTA_REMETENTE,
	F.PRAZO_MEDIO_ENTREGA,
	F.GERA_FATURAMENTO,
	F.NUM_DIAS_PRIMEIRO_VENCIMENTO,
	F.NUM_DIAS_INTERVALO,
	F.QUANTIDADE_PARCELAS,
	E.LOGRADOURO, E.NUMERO, E.COMPLEMENTO, E.BAIRRO, E.CIDADE, E.CEP, E.MUNICIPIO_IBGE, E.UF, E.FONE, 
	P.NOME, P.TIPO, P.EMAIL, P.SITE, PF.CPF AS "CPF_CNPJ"
from
	PESSOA P 
	INNER JOIN PESSOA_FISICA PF ON (PF.ID_PESSOA = P.ID)
	INNER JOIN FORNECEDOR F ON (F.ID_PESSOA = P.ID)
	INNER JOIN PESSOA_ENDERECO E ON (E.ID_PESSOA = P.ID)
where 
	P.FORNECEDOR = "S" and E.PRINCIPAL = "S"

union

select 
	F.ID,
	F.ID_CONTABIL_CONTA,
	F.ID_PESSOA,
	F.ID_ATIVIDADE_FOR_CLI,
	F.ID_SITUACAO_FOR_CLI,
	F.DESDE,
	F.OPTANTE_SIMPLES_NACIONAL,
	F.LOCALIZACAO,
	F.DATA_CADASTRO,
	F.SOFRE_RETENCAO,
	F.CHEQUE_NOMINAL_A,
	F.OBSERVACAO,
	F.CONTA_REMETENTE,
	F.PRAZO_MEDIO_ENTREGA,
	F.GERA_FATURAMENTO,
	F.NUM_DIAS_PRIMEIRO_VENCIMENTO,
	F.NUM_DIAS_INTERVALO,
	F.QUANTIDADE_PARCELAS,
	E.LOGRADOURO, E.NUMERO, E.COMPLEMENTO, E.BAIRRO, E.CIDADE, E.CEP, E.MUNICIPIO_IBGE, E.UF, E.FONE, 
	P.NOME, P.TIPO, P.EMAIL, P.SITE, PJ.CNPJ AS "CPF_CNPJ"
from
	PESSOA P 
	INNER JOIN PESSOA_JURIDICA PJ ON (PJ.ID_PESSOA = P.ID)
	INNER JOIN FORNECEDOR F ON (F.ID_PESSOA = P.ID)
	INNER JOIN PESSOA_ENDERECO E ON (E.ID_PESSOA = P.ID)
where 
	P.FORNECEDOR = "S" and E.PRINCIPAL = "S"
