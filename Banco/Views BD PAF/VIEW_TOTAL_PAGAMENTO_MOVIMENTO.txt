CREATE OR ALTER VIEW VIEW_TOTAL_PAGAMENTO_MOVIMENTO(
    ID,
    ID_ECF_MOVIMENTO,
    DESCRICAO,
    VALOR_APURADO)
AS
select
    CAST(VC.ID_ECF_MOVIMENTO || TP.ID AS INTEGER) as ID, VC.ID_ECF_MOVIMENTO, TP.DESCRICAO, SUM(TTP.VALOR) AS VALOR_APURADO from ECF_TOTAL_TIPO_PAGAMENTO TTP
        INNER JOIN ecf_venda_cabecalho VC ON (TTP.ID_ECF_VENDA_CABECALHO = VC.ID)
        INNER JOIN ecf_tipo_pagamento TP ON (TTP.ID_ECF_TIPO_PAGAMENTO = TP.ID)
        GROUP BY ID, VC.ID_ECF_MOVIMENTO, TP.DESCRICAO
;