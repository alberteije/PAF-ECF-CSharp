CREATE OR ALTER VIEW VIEW_TOTAL_PAGAMENTO_DATA(
    ID,
    DATA_VENDA,
    ID_TIPO_PAGAMENTO,
    DESCRICAO,
    VALOR_APURADO)
AS
select
        CAST( EXTRACT(YEAR FROM VC.DATA_VENDA) || EXTRACT(MONTH FROM VC.DATA_VENDA) || EXTRACT(DAY FROM VC.DATA_VENDA) || TP.ID AS INTEGER) as ID,
        VC.DATA_VENDA, TP.ID AS ID_TIPO_PAGAMENTO, TP.DESCRICAO, SUM(TTP.VALOR) AS VALOR_APURADO from ECF_TOTAL_TIPO_PAGAMENTO TTP
        INNER JOIN ecf_venda_cabecalho VC ON (TTP.ID_ECF_VENDA_CABECALHO = VC.ID)
        INNER JOIN ecf_tipo_pagamento TP ON (TTP.ID_ECF_TIPO_PAGAMENTO = TP.ID)
        GROUP BY ID, VC.DATA_VENDA, ID_TIPO_PAGAMENTO, TP.DESCRICAO
        ORDER BY VC.DATA_VENDA, TP.DESCRICAO
;